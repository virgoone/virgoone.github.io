<!DOCTYPE html>
<html lang="en">
    <meta name="referrer" content="origin"> 
<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--Description-->
    
        <meta name="description" content="前端开发，DJI爱好者，入坑Mavic，工作在上海">
    

    <!--Author-->
    
        <meta name="author" content="Koya">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="搭建自己的Git服务器-Gitea安装教程"/>
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Koya&#39;s Blog"/>

    <!--Page Cover-->
    
        <meta property="og:image" content=""/>
    

    <!-- Title -->
    
    <title>搭建自己的Git服务器-Gitea安装教程 - Koya&#39;s Blog</title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/sass/main.css">


    <!--[if lt IE 8]>
        
<script src="/js/ie/html5shiv.js"></script>

    <![endif]-->

    <!--[if lt IE 8]>
        
<link rel="stylesheet" href="/sass/ie8.css">

    <![endif]-->

    <!--[if lt IE 9]>
        
<link rel="stylesheet" href="/sass/ie9.css">

    <![endif]-->

    <!-- Gallery -->
    <link href="https://cdn.bootcss.com/featherlight/1.4.0/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-90536291-1', 'auto');
        ga('send', 'pageview');

    </script>



    <!-- la Analytics -->
    
    <script>
        !function(p){"use strict";!function(t){var s=window,e=document,i=p,c="".concat("https:"===e.location.protocol?"https://":"http://","sdk.51.la/js-sdk-pro.min.js"),n=e.createElement("script"),r=e.getElementsByTagName("script")[0];n.type="text/javascript",n.setAttribute("charset","UTF-8"),n.async=!0,n.src=c,n.id="LA_COLLECT",i.d=n;var o=function(){s.LA.ids.push(i)};s.LA?s.LA.ids&&o():(s.LA=p,s.LA.ids=[],o()),r.parentNode.insertBefore(n,r)}()}({id:"JHRJXYlwhd65yctP",ck:"JHRJXYlwhd65yctP"});
    </script>


<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Koya's Blog" type="application/atom+xml">
</head>

<body>
    <div id="wrapper">

        <!-- Menu -->
        <!-- Header -->
<header id="header">
    <div class="inner">

        <!-- Logo -->
        <a href="/" class="logo">
            <span class="symbol"><img src="/images/logo.svg" alt="" /></span><span class="title">Koya's Blog</span>
        </a>

        <!-- Nav -->
        <nav>
            <ul>
                <li><a href="#menu">Menu</a></li>
            </ul>
        </nav>

    </div>
</header>

<!-- Menu -->
<nav id="menu">
    <h2>Menu</h2>
    <ul>
        
            <li>
                <a href="/">Home</a>
            </li>
        
            <li>
                <a href="/archives">Archives</a>
            </li>
        
            <li>
                <a href="/about">About</a>
            </li>
        
            <li>
                <a href="/tags">Tags</a>
            </li>
        
    </ul>
</nav>


        <div id="main">
            <div class="inner">

                <!-- Main Content -->
                

    <h1 class="title">搭建自己的Git服务器-Gitea安装教程</h1>
    <div class="meta">
        <div class="date">2018-06-08</div>
        
        <div class="post-meta-divider">|</div>
        <div id="/build-own-git-server/" class="leancloud-visitors" data-flag-title="搭建自己的Git服务器-Gitea安装教程">
            <em class="post-meta-item-text">阅读量: </em>
            <i class="leancloud-visitors-count"></i>
        </div>
        
    </div>



    <span class="image main"><img src="https://m-staticcdn.annatarhe.com//blog/poster/qtxbmx321qp.jpg" alt="" /></span>


<hr />

<!-- Gallery -->


<!-- Content -->
<p>好久没有写过博客了，续费域名时突然想起来有个博客已经很久未更新了</p>
<p>突然觉得浪费了之前的一波配置😂，现在更新一波</p>
<p>顺便对博客的样式做了个更新放弃了hexo，可能是因为hexo太重了，找了一个比较轻量级的theme替代了hexo</p>
<h2 id="自架Git-Service的选择"><a href="#自架Git-Service的选择" class="headerlink" title="自架Git Service的选择"></a>自架Git Service的选择</h2><p>最近也是突然对搭建自己的git服务器有了一点想法，随后搜索了现在主流的开源git</p>
<ul>
<li>Gogs 使用go开发的git service</li>
<li>Gitlab 目前比较火的</li>
<li>Gitea 基于gogs开发</li>
</ul>
<h3 id="Gogs"><a href="#Gogs" class="headerlink" title="Gogs"></a>Gogs</h3><p>参考 Gogs 文档 里描述</p>
<blockquote>
<p>Gogs 是一款极易搭建的自助 Git 服务。<br>Gogs 的目标是打造一个最简单、最快速和最轻松的方式搭建自助 Git服 务。使用 Go 语言开发使得 Gogs 能够通过独立的二进制分发，并且支持 Go 语言支持的 所有平台，包括 Linux、Mac OS X、Windows 以及 ARM 平台。</p>
</blockquote>
<p>Gogs 是由 Unknwon 发起的，目前为止他是 Gogs 主要的代码贡献者和唯一的维护者，换直白一点的话就是，Gogs 的代码不全是他写的，但主要是他写的，且他是唯一一个有权决定别人的代码是否被合并到 Gogs 的人</p>
<h3 id="Gitlab"><a href="#Gitlab" class="headerlink" title="Gitlab"></a>Gitlab</h3><p>来自 谷歌 描述</p>
<blockquote>
<p>GitLab 是利用 Ruby on Rails 一个开源的版本管理系统，实现一个自托管的Git项目仓库，可通过Web界面进行访问公开的或者私人项目。它拥有与Github类似的功能，能够浏览源代码，管理缺陷和注释。可以管理团队对仓库的访问，它非常易于浏览提交过的版本并提供一个文件历史库。团队成员可以利用内置的简单聊天程序(Wall)进行交流。它还提供一个代码片段收集功能可以轻松实现代码复用，便于日后有需要的时候进行查找。</p>
</blockquote>
<p>Gitlab现在也是一个比较火的自建Git服务的选择，不过Gitlab对于服务器的要求比较高，当然如果想尝试的话可以搭建试一下</p>
<p>PS：<a target="_blank" rel="noopener" href="https://www.liulishuo.com">流利说</a> 现在的Git服务器使用的是自建的Gitlab</p>
<h3 id="Gitea"><a href="#Gitea" class="headerlink" title="Gitea"></a>Gitea</h3><p>来自 Gitea 文档 里描述</p>
<blockquote>
<p>Gitea 是一个开源社区驱动的 Gogs 克隆</p>
</blockquote>
<p>当然更神奇的是Gitea的博客的描述的：</p>
<blockquote>
<p>Gitea is a community fork of the popular self-hosted Git service Gogs. We’re a growing group of former Gogs users and contributors who found the single-maintainer management model of Gogs frustrating and thus decided to make an effort to build a more open and faster development model.</p>
<p>This happened not before trying to convince @Unknwon about giving write permissions to more people, among the community. He rightly considered Gogs his own creature and didn’t want to let it grow outside of him, thus a fork was necessary in order to set that code effectively free.</p>
<p>As Kahlil Gibran wrote about children:</p>
<blockquote>
<p>Your children are not your children. They are the sons and daughters of Life’s longing for itself. They come through you but not from you, and though they are with you yet they belong not to you.</p>
</blockquote>
<p>Gitea has 3 owners which are elected yearly and an open number of maintainers who decide with a simple voting model which contributions get accepted and who will play the owner role. Anyone with at least 4 contributions accepted can apply to become a maintainer.</p>
<p>Since the fork at the beginning of November 2016 Gitea got 193 pull requests merged and 43 issues closed. Among management issues and cleanups, 11 bugs were closed. Another 26 PR are pending merges, many of which are just waiting for 1.0.0 to be released as most new features will start appearing in 1.1.0.</p>
<p>We invite everyone to join the effort and help continue building the next generation of self-hosted Git service.</p>
</blockquote>
<p>有兴趣的话可以到下方博客链接中看一下Gitea和Gogs的对比差异</p>
<p>而今天的博客也主要讲的是如何在自己的服务器中安装Gitea</p>
<p>选择Gitea的原因主要是和Gogs的差异并不是很大，但是相比较commit却要远远的超过Gogs的，相比觉得最起码在问题处理上要超过Gogs</p>
<p>好了，闲话少说，开始安装吧</p>
<h2 id="在自己的服务器中安装Gitea"><a href="#在自己的服务器中安装Gitea" class="headerlink" title="在自己的服务器中安装Gitea"></a>在自己的服务器中安装Gitea</h2><p>我们这次主要通过docker的方式来安装</p>
<h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><ul>
<li>安装 docker</li>
<li>安装 docker-compose</li>
<li>安装 nginx</li>
</ul>
<h3 id="编写-docker-compose-yml-文件"><a href="#编写-docker-compose-yml-文件" class="headerlink" title="编写 docker-compose.yml 文件"></a>编写 docker-compose.yml 文件</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">    <span class="attr">gitea:</span></span><br><span class="line">      <span class="attr">external:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">    <span class="attr">gitea:</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">gitea/gitea:latest</span></span><br><span class="line">      <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">      <span class="attr">networks:</span></span><br><span class="line">       <span class="bullet">-</span> <span class="string">gitea</span></span><br><span class="line">      <span class="attr">ports:</span></span><br><span class="line">       <span class="bullet">-</span> <span class="string">&quot;10022:22&quot;</span></span><br><span class="line">       <span class="bullet">-</span> <span class="string">&quot;3000:3000&quot;</span></span><br><span class="line">      <span class="attr">environment:</span></span><br><span class="line">       <span class="bullet">-</span> <span class="string">&quot;USER_UID=1000&quot;</span></span><br><span class="line">       <span class="bullet">-</span> <span class="string">&quot;USER_GID=1000&quot;</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">       <span class="bullet">-</span> <span class="string">&quot;/root/sites/gitea:/data&quot;</span></span><br></pre></td></tr></table></figure>

<p>使用 3000 做为Gitea Web服务器端口，10022映射ssh端口</p>
<h3 id="启动-Gitea-服务"><a href="#启动-Gitea-服务" class="headerlink" title="启动 Gitea 服务"></a>启动 Gitea 服务</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

<p>启动之后 <code>curl localhost:3000</code> 验证是否启动成功</p>
<p>如果启动失败，可以执行以下命令查看报错信息</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose logs</span><br></pre></td></tr></table></figure>

<h3 id="配置-nginx-代理"><a href="#配置-nginx-代理" class="headerlink" title="配置 nginx 代理"></a>配置 nginx 代理</h3><p>如果想提供给外网访问，还需要最后一步，配置nginx代理到Gitea服务</p>
<p>配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">## 将HTTP请求全部重定向至HTTPS</span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  git.marryto.me;</span><br><span class="line">    charset utf-8;</span><br><span class="line">    rewrite ^ https://git.marryto.me;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">## 请求转发到Gitea容器</span><br><span class="line">server &#123;</span><br><span class="line">    listen       443 ssl;</span><br><span class="line">    server_name  git.marryto.me;</span><br><span class="line">    charset utf-8;</span><br><span class="line">    ssl on;</span><br><span class="line">    ssl_certificate         /etc/*/live/*/fullchain.pem;</span><br><span class="line">    ssl_certificate_key     /etc/*/live/*/privkey.pem;</span><br><span class="line">    ssl_session_timeout     10m;</span><br><span class="line">    ssl_session_cache       shared:SSL:10m;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto https;</span><br><span class="line">        proxy_pass    http://127.0.0.1:3000;</span><br><span class="line">    &#125;</span><br><span class="line">    location ~ .*\.(js|css|png)$ &#123;</span><br><span class="line">        proxy_pass  http://127.0.0.1:3000;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们这里使用的是SSL，通过 Letsencrypt 可以免费申请域名证书，现在访问 <a target="_blank" rel="noopener" href="https://git.marryto.me/">https://git.marryto.me</a>  就可以访问到我们刚刚搭建的Gitea服务器</p>
<p>当我们第一次访问Gitea服务器时，会进入 <a target="_blank" rel="noopener" href="https://git.marryto.me/install">https://git.marryto.me/install</a> 设置服务器信息，包含数据库，可选有Postgres、Mysql和SqlLite等，设置完成后我们就可以进入到自己的Git服务器了，如下：</p>
<img class="lazy" data-original='https://m-staticcdn.annatarhe.com//blog/5b1aaef9975bb.png' title='git.marryto.me' alt='git.marryto.me'/>

<p>好了，我们的安装就到这里，以下是关联的资料</p>
<h2 id="资料："><a href="#资料：" class="headerlink" title="资料："></a>资料：</h2><p><a target="_blank" rel="noopener" href="https://blog.gitea.io/2016/12/welcome-to-gitea/">https://blog.gitea.io/2016/12/welcome-to-gitea/</a><br><a target="_blank" rel="noopener" href="https://blog.wolfogre.com/posts/gogs-vs-gitea/">https://blog.wolfogre.com/posts/gogs-vs-gitea/</a><br><a target="_blank" rel="noopener" href="https://docs.gitea.io/en-us/comparison/">https://docs.gitea.io/en-us/comparison/</a></p>


<!-- Tags -->



<div class="tags">
    <a href="/tags/git/" class="button small">git</a> <a href="/tags/gitea/" class="button small">gitea</a> <a href="/tags/git服务器搭建/" class="button small">git服务器搭建</a> <a href="/tags/gitlab/" class="button small">gitlab</a>
</div>



<!-- Comments -->
<div>
    





    <hr />
    <div id="vcomments"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine@latest/dist/Valine.min.js'></script>
    <script>
    new Valine({
        el: '#vcomments' ,
        appId: 'VDJQPQkWcae55MrsKrmNSw5j-gzGzoHsz',
        appKey: 'n2xrQtPGJXzsR9rRdkB2nlPy',
        notify:false, 
        verify:false,
        visitor: 'true',
        avatar:'SS', 
        placeholder: '评论点什么吧~' 
    });
    </script>

</div>



            </div>
        </div>

        <!-- Footer -->
<footer id="footer">
    <div class="inner">
        <section>
            <h2>About</h2>
            <div>
                工作在<a href="https://www.liulishuo.com/" target="_blank">流利说</a>，前端打杂，了解请至 <a href="/about" target="_blank">关于我</a>
            </div>
        </section>
        <section>
            <h2>Follow</h2>
            <ul class="icons">
                
                
                
                    <li><a href="https://www.instagram.com/koya.site/" class="icon style2 fa-instagram" target="_blank" ><span class="label">Instagram</span></a></li>
                
                
                
                    <li><a href="https://github.com/virgoone" class="icon style2 fa-github" target="_blank" ><span class="label">GitHub</span></a></li>
                
                
                
                
                
                    <li><a href="mailto:me@virgo.one" class="icon style2 fa-envelope-o" target="_blank" ><span class="label">Email</span></a></li>
                
                
                    <li><a href="https://blog.marryto.me/atom.xml" class="icon style2 fa-rss" target="_blank" ><span class="label">RSS</span></a></li>
                
            </ul>
        </section>
        <ul class="copyright">
            <li>&copy; Untitled. All rights reserved</li>
            <li>Design: <a href="http://html5up.net" target="_blank">HTML5 UP</a></li>
            <li>Hexo: <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></li>
            <li>Hosted by <a href="http://t.douni.one/zeit" target="_blank">ZEIT</a></li>
        </ul>
    </div>
</footer>
    </div>

    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js" type="text/javascript" charset="utf-8"></script>

<script src="https://cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script>
<!-- skel -->
<script src="https://cdn.bootcss.com/skel/3.0.0/skel.min.js" type="text/javascript" charset="utf-8"></script>
<!-- Custom Code -->

<script src="/js/util.js"></script>


<!--[if lte IE 8]>

<script src="/js/ie/respond.min.js"></script>

<![endif]-->

<!-- Custom Code -->

<script src="/js/main.js"></script>


<!-- Gallery -->
<script src="https://cdn.bootcss.com/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->


</body>

</html>